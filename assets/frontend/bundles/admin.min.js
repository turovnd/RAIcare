var admin=function(e){function n(t){if(a[t])return a[t].exports;var o=a[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var a={};return n.m=e,n.c=a,n.i=function(e){return e},n.d=function(e,a,t){n.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:t})},n.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(a,"a",a),a},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=209)}({172:function(e,n){e.exports=function(e){var n=null,a=null,t=null,o=function(e){e.preventDefault();var a={url:"/admin/organization/create",type:"POST",data:new FormData(n),beforeSend:function(){n.getElementsByClassName("modal__wrapper")[0].classList.add("loading")},success:function(e){e=JSON.parse(e),n.getElementsByClassName("modal__wrapper")[0].classList.remove("loading"),131===parseInt(e.code)&&window.location.reload(),raicare.notification.notify({type:e.status,message:e.message})},error:function(e){raicare.core.log("ajax error occur on creating new organization","error","Admin: organizations",e),n.getElementsByClassName("modal__wrapper")[0].classList.remove("loading")}};raicare.ajax.send(a)},s=function(e){var n=e.closest(".js-field-name"),o=n.getElementsByClassName("form-group__control")[0],s=new FormData,r=[],i=[];if(s.append("csrf",document.getElementById("csrf").value),s.append("id",a.value),s.append("name",o.name),s.append("value",o.value),"users[]"===o.name){for(var l=o.getElementsByTagName("option"),c=0;c<l.length;c++)-1===r.indexOf(l[c].value)&&(r.push(l[c].value),i.push(l[c].textContent));s.append("value",JSON.stringify(r))}var u={url:"/admin/organization/update",type:"POST",data:s,beforeSend:function(){t.classList.add("loading")},success:function(e){if(e=JSON.parse(e),t.classList.remove("loading"),135===parseInt(e.code))if(n.getElementsByClassName("form-group__control-static")[0].classList.toggle("hide"),n.getElementsByClassName("form-group__control-group")[0].classList.toggle("hide"),"owner"===o.name)n.getElementsByClassName("js-organization-info")[0].textContent=n.getElementsByClassName("form-group__control")[0].getElementsByTagName("option")[0].textContent,n.getElementsByClassName("js-organization-info")[0].href=window.location.origin+"/user/"+o.value;else if("users[]"===o.name){var a=n.getElementsByClassName("form-group__control-static")[0];for(a.innerHTML="",c=0;c<r.length;c++)a.innerHTML+='<a href="'+window.location.origin+"/user/"+r[c]+'" class="js-organization-info link m-r-10">'+i[c]+"</a>";a.innerHTML+='<a onclick="admin.organizations.edit(this)" role="button" class="m-l-5"><i class="fa fa-pencil" aria-hidden="true"></i></a>'}else n.getElementsByClassName("js-organization-info")[0].textContent=o.value;raicare.notification.notify({type:e.status,message:e.message})},error:function(e){raicare.core.log("ajax error occur on updating organization info","error","Admin: organizations",e),t.classList.remove("loading")}};raicare.ajax.send(u)};return e.update=function(e){s(e)},e.edit=function(e){var n=e.closest(".js-field-name");n.getElementsByClassName("form-group__control-static")[0].classList.toggle("hide"),n.getElementsByClassName("form-group__control-group")[0].classList.toggle("hide")},e.init=function(e){if("all"===e)n=document.getElementById("newOrganizationModal"),n.addEventListener("submit",o),new DataTable("#organizations",{perPage:20,perPageSelect:[20,40,60,80,100],searchable:!0,sortable:!0,labels:{placeholder:"Поиск...",perPage:"{select} оргнизаций на странице",noRows:"Организации не найдены",info:"Показано с {start} по {end} из {rows}"},nextPrev:!1,footer:!0});else{a=document.getElementById("organizationID"),t=document.getElementById("organizationInfo");var s=new raicare.choices("#organizationUsers",{placeholderValue:"Введите имя или логин пользователя",loadingText:"Загрузка...",noResultsText:"Ничего не найдено",noChoicesText:"Нет элементов для выбора",itemSelectText:"выбрать",searchEnabled:!0,searchChoices:!1,shouldSort:!1,searchFloor:2,searchResultLimit:30,resetScrollPosition:!1});s.passedElement.addEventListener("search",function(e){s.ajax(function(){fetch("/admin/user/get?name="+e.detail.value).then(function(e){return e.json()}).then(function(e){s.setChoices(e,"id","search",!0)}).catch(function(e){console.log(e)})})})}var r=new raicare.choices("#organizationOwner",{placeholderValue:"Введите имя или логин пользователя",loadingText:"Загрузка...",noResultsText:"Ничего не найдено",noChoicesText:"Нет элементов для выбора",itemSelectText:"выбрать",searchEnabled:!0,searchChoices:!1,shouldSort:!1,searchFloor:2,searchResultLimit:30,resetScrollPosition:!1});r.passedElement.addEventListener("search",function(e){r.ajax(function(){fetch("/admin/user/get?name="+e.detail.value).then(function(e){return e.json()}).then(function(e){r.setChoices(e,"id","search",!0)}).catch(function(e){console.log(e)})})})},e}({})},173:function(e,n){e.exports=function(e){var n=null,a=null,t=null,o=function(e){e.preventDefault();var a={url:"/admin/pension/create",type:"POST",data:new FormData(n),beforeSend:function(){n.getElementsByClassName("modal__wrapper")[0].classList.add("loading")},success:function(e){e=JSON.parse(e),n.getElementsByClassName("modal__wrapper")[0].classList.remove("loading"),141===parseInt(e.code)&&window.location.reload(),raicare.notification.notify({type:e.status,message:e.message})},error:function(e){raicare.core.log("ajax error occur on creating new pension","error","Admin: pensions",e),n.getElementsByClassName("modal__wrapper")[0].classList.remove("loading")}};raicare.ajax.send(a)},s=function(e){var n=e.closest(".js-field-name"),o=n.getElementsByClassName("form-group__control")[0],s=new FormData,r=[];if(s.append("csrf",document.getElementById("csrf").value),s.append("id",a.value),s.append("name",o.name),s.append("value",o.value),"users[]"===o.name){for(var i=o.getElementsByTagName("option"),l=0;l<i.length;l++)-1===r.indexOf(i[l].value)&&r.push(i[l].value);s.append("value",JSON.stringify(r))}var c={url:"/admin/pension/update",type:"POST",data:s,beforeSend:function(){t.classList.add("loading")},success:function(e){if(e=JSON.parse(e),t.classList.remove("loading"),145===parseInt(e.code))if(n.getElementsByClassName("form-group__control-static")[0].classList.toggle("hide"),n.getElementsByClassName("form-group__control-group")[0].classList.toggle("hide"),"organization"===o.name)n.getElementsByClassName("js-pension-info")[0].textContent=n.getElementsByClassName("form-group__control")[0].getElementsByTagName("option")[0].textContent,n.getElementsByClassName("js-pension-info")[0].href=window.location.origin+"/organization/"+o.value;else if("users[]"===o.name){var a=n.getElementsByClassName("form-group__control-static")[0],s=e.users;for(a.innerHTML="",l=0;l<s.length;l++)a.innerHTML+='<a href="'+window.location.origin+"/user/"+s[l].id+'" class="js-pension-info link m-r-10">'+s[l].name+" ("+s[l].username+")</a>";a.innerHTML+='<a onclick="admin.pensions.edit(this)" role="button" class="m-l-5"><i class="fa fa-pencil" aria-hidden="true"></i></a>'}else n.getElementsByClassName("js-pension-info")[0].textContent=o.value;raicare.notification.notify({type:e.status,message:e.message})},error:function(e){raicare.core.log("ajax error occur on updating pension info","error","Admin: pensions",e),t.classList.remove("loading")}};raicare.ajax.send(c)};return e.update=function(e){s(e)},e.edit=function(e){var n=e.closest(".js-field-name");n.getElementsByClassName("form-group__control-static")[0].classList.toggle("hide"),n.getElementsByClassName("form-group__control-group")[0].classList.toggle("hide")},e.init=function(e){if("all"===e)n=document.getElementById("newPensionModal"),n.addEventListener("submit",o),new DataTable("#pensions",{perPage:20,perPageSelect:[20,40,60,80,100],searchable:!0,sortable:!0,labels:{placeholder:"Поиск...",perPage:"{select} оргнизаций на странице",noRows:"Организации не найдены",info:"Показано с {start} по {end} из {rows}"},nextPrev:!1,footer:!0});else{a=document.getElementById("pensionID"),t=document.getElementById("pensionInfo");var s=new raicare.choices("#pensionUsers",{placeholderValue:"Введите имя или логин пользователя",loadingText:"Загрузка...",noResultsText:"Ничего не найдено",noChoicesText:"Нет элементов для выбора",itemSelectText:"выбрать",searchEnabled:!0,searchChoices:!1,shouldSort:!1,searchFloor:2,searchResultLimit:30,resetScrollPosition:!1});s.passedElement.addEventListener("search",function(e){s.ajax(function(){fetch("/admin/user/get?name="+e.detail.value).then(function(e){return e.json()}).then(function(e){s.setChoices(e,"id","search",!0)}).catch(function(e){console.log(e)})})})}var r=new raicare.choices("#pensionOrganization",{placeholderValue:"Введите имя или логин пользователя",loadingText:"Загрузка...",noResultsText:"Ничего не найдено",noChoicesText:"Нет элементов для выбора",itemSelectText:"выбрать",searchEnabled:!0,searchChoices:!1,shouldSort:!1,searchFloor:2,searchResultLimit:30,resetScrollPosition:!1});r.passedElement.addEventListener("search",function(e){r.ajax(function(){fetch("/admin/organization/get?name="+e.detail.value).then(function(e){return e.json()}).then(function(e){r.setChoices(e,"id","name",!0)}).catch(function(e){console.log(e)})})})},e}({})},174:function(e,n){e.exports=function(e){var n=null,a=null,t=null,o=function(e){e.preventDefault();var n={url:"/admin/role/create",type:"POST",data:new FormData(a),beforeSend:function(){a.getElementsByClassName("modal__wrapper")[0].classList.add("loading")},success:function(e){e=JSON.parse(e),a.getElementsByClassName("modal__wrapper")[0].classList.remove("loading"),100===parseInt(e.code)&&window.location.reload(),raicare.notification.notify({type:e.status,message:e.message})},error:function(e){raicare.core.log("ajax error occur on creating new role","error","Admin: roles",e),a.getElementsByClassName("modal__wrapper")[0].classList.remove("loading")}};raicare.ajax.send(n)},s=function(e){e.preventDefault();var a={url:"/admin/role/update",type:"POST",data:new FormData(t),beforeSend:function(){t.getElementsByClassName("modal__wrapper")[0].classList.add("loading")},success:function(e){e=JSON.parse(e),t.getElementsByClassName("modal__wrapper")[0].classList.remove("loading"),101===parseInt(e.code)&&(n.getElementsByTagName("td")[1].textContent=document.getElementById("updateRoleName").value),raicare.modal.hide(t),raicare.notification.notify({type:e.status,message:e.message})},error:function(e){raicare.core.log("ajax error occur on updating role","error","Admin: roles",e),t.getElementsByClassName("modal__wrapper")[0].classList.remove("loading")}};raicare.ajax.send(a)},r=function(e){var n=new FormData;n.append("id",e),n.append("csrf",document.getElementById("csrf").value);var a={url:"/admin/role/delete",type:"POST",data:n,beforeSend:function(){document.body.classList.add("loading")},success:function(e){e=JSON.parse(e),document.body.classList.remove("loading"),102===parseInt(e.code)&&window.location.reload(),raicare.notification.notify({type:e.status,message:e.message})},error:function(e){raicare.core.log("ajax error occur on deleting role","error","Admin: roles",e),document.body.classList.remove("loading")}};raicare.ajax.send(a)};return e.openmodal=function(e){n=e.parentNode.parentNode,document.getElementById("currentRoleID").value=n.getElementsByTagName("td")[0].textContent,document.getElementById("updateRoleName").value=n.getElementsByTagName("td")[1].textContent,raicare.modal.show(t)},e.delete=function(e){r(e)},e.init=function(){t=document.getElementById("updateRoleModal"),t.addEventListener("submit",s),a=document.getElementById("newRoleModal"),a.addEventListener("submit",o)},e}({})},175:function(e,n){e.exports=function(e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890",a=null,t=null,o=null,s=function(e){e.preventDefault();var n={url:"/admin/user/create",type:"POST",data:new FormData(a),beforeSend:function(){a.getElementsByClassName("modal__wrapper")[0].classList.add("loading")},success:function(e){e=JSON.parse(e),a.getElementsByClassName("modal__wrapper")[0].classList.remove("loading"),50===parseInt(e.code)&&window.location.reload(),raicare.notification.notify({type:e.status,message:e.message})},error:function(e){raicare.core.log("ajax error occur on creating new user","error","Admin: users",e),a.getElementsByClassName("modal__wrapper")[0].classList.remove("loading")}};raicare.ajax.send(n)},r=function(e){var n=e.closest(".js-field-name"),a=n.getElementsByClassName("form-group__control")[0],s=new FormData,r=[],i=[];if(s.append("csrf",document.getElementById("csrf").value),s.append("id",t.value),s.append("name",a.name),s.append("value",a.value),"pensions[]"===a.name){for(var l=a.getElementsByTagName("option"),c=0;c<l.length;c++)-1===r.indexOf(l[c].value)&&(r.push(l[c].value),i.push(l[c].textContent));s.append("value",JSON.stringify(r))}var u={url:"/admin/user/update",type:"POST",data:s,beforeSend:function(){o.classList.add("loading")},success:function(e){if(e=JSON.parse(e),o.classList.remove("loading"),53===parseInt(e.code))if(n.getElementsByClassName("form-group__control-static")[0].classList.toggle("hide"),n.getElementsByClassName("form-group__control-group")[0].classList.toggle("hide"),"role"===a.name)n.getElementsByClassName("js-user-info")[0].textContent=n.getElementsByClassName("form-group__control")[0].getElementsByTagName("option")[0].textContent;else if("organization"===a.name)n.getElementsByClassName("js-user-info")[0].textContent=n.getElementsByClassName("form-group__control")[0].getElementsByTagName("option")[0].textContent,n.getElementsByClassName("js-user-info")[0].href=window.location.origin+"/organization/"+a.value;else if("pensions[]"===a.name){var t=n.getElementsByClassName("form-group__control-static")[0];for(t.innerHTML="",c=0;c<r.length;c++)t.innerHTML+='<a href="'+window.location.origin+"/pension/"+r[c]+'" class="js-user-info link m-r-10">'+i[c]+"</a>";t.innerHTML+='<a onclick="admin.users.edit(this)" role="button" class="m-l-5"><i class="fa fa-pencil" aria-hidden="true"></i></a>'}else n.getElementsByClassName("js-user-info")[0].textContent=a.value;raicare.notification.notify({type:e.status,message:e.message})},error:function(e){raicare.core.log("ajax error occur on updating user info","error","Admin: users",e),o.classList.remove("loading")}};raicare.ajax.send(u)};return e.update=function(e){r(e)},e.edit=function(e){var n=e.closest(".js-field-name");n.getElementsByClassName("form-group__control-static")[0].classList.toggle("hide"),n.getElementsByClassName("form-group__control-group")[0].classList.toggle("hide")},e.randompassword=function(e){for(var a,t="",o=0;o<10;o++)a=Math.floor(Math.random()*n.length),t+=n.substring(a,a+1);e.parentNode.getElementsByTagName("input")[0].value=t},e.init=function(e){if("all"===e)a=document.getElementById("newUserModal"),a.addEventListener("submit",s),new DataTable("#users",{perPage:20,perPageSelect:[20,40,60,80,100],searchable:!0,sortable:!0,labels:{placeholder:"Поиск...",perPage:"{select} пользователей на странице",noRows:"Пользователи не найдены",info:"Показано с {start} по {end} из {rows}"},nextPrev:!1,footer:!0});else{t=document.getElementById("userID"),o=document.getElementById("userInfo");var n=new raicare.choices("#userOrganization",{placeholderValue:"Введите название организации",loadingText:"Загрузка...",noResultsText:"Ничего не найдено",noChoicesText:"Нет элементов для выбора",itemSelectText:"выбрать",searchEnabled:!0,searchChoices:!1,searchFloor:2,searchResultLimit:30,resetScrollPosition:!1});n.passedElement.addEventListener("search",function(e){n.ajax(function(){fetch("/admin/organization/get?name="+e.detail.value).then(function(e){return e.json()}).then(function(e){n.setChoices(e,"id","name",!0)}).catch(function(e){console.log(e)})})});var r=new raicare.choices("#userPensions",{removeItemButton:!0,placeholderValue:"Введите название пансионата",loadingText:"Загрузка...",noResultsText:"Ничего не найдено",noChoicesText:"Нет элементов для выбора",itemSelectText:"выбрать",searchEnabled:!0,searchChoices:!1,searchFloor:2,searchResultLimit:30,resetScrollPosition:!1});r.passedElement.addEventListener("search",function(e){r.ajax(function(){fetch("/admin/pension/get?name="+e.detail.value).then(function(e){return e.json()}).then(function(e){r.setChoices(e,"id","name",!0)}).catch(function(e){console.log(e)})})})}},e}({})},209:function(e,n,a){e.exports=function(e){return e.roles=a(174),e.users=a(175),e.organizations=a(172),e.pensions=a(173),e}({})}});