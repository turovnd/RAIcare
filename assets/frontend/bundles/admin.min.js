var admin=function(e){function t(a){if(n[a])return n[a].exports;var o=n[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=210)}({172:function(e,t){e.exports=function(e){var t=null,n=null,a=null,o=function(e){e.preventDefault();var t={url:"/admin/role/create",type:"POST",data:new FormData(n),beforeSend:function(){n.getElementsByClassName("modal__wrapper")[0].classList.add("loading")},success:function(e){e=JSON.parse(e),n.getElementsByClassName("modal__wrapper")[0].classList.remove("loading"),100===parseInt(e.code)&&window.location.reload(),raicare.notification.notify({type:e.status,message:e.message})},error:function(e){raicare.core.log("ajax error occur on creating new role","error","Admin: roles",e),n.getElementsByClassName("modal__wrapper")[0].classList.remove("loading")}};raicare.ajax.send(t)},r=function(e){e.preventDefault();var n={url:"/admin/role/update",type:"POST",data:new FormData(a),beforeSend:function(){a.getElementsByClassName("modal__wrapper")[0].classList.add("loading")},success:function(e){e=JSON.parse(e),a.getElementsByClassName("modal__wrapper")[0].classList.remove("loading"),101===parseInt(e.code)&&(t.getElementsByTagName("td")[1].textContent=document.getElementById("updateRoleName").value),raicare.modal.hide(a),raicare.notification.notify({type:e.status,message:e.message})},error:function(e){raicare.core.log("ajax error occur on updating role","error","Admin: roles",e),a.getElementsByClassName("modal__wrapper")[0].classList.remove("loading")}};raicare.ajax.send(n)},s=function(e){var t=new FormData;t.append("id",e),t.append("csrf",document.getElementById("csrf").value);var n={url:"/admin/role/delete",type:"POST",data:t,beforeSend:function(){document.body.classList.add("loading")},success:function(e){e=JSON.parse(e),document.body.classList.remove("loading"),102===parseInt(e.code)&&window.location.reload(),raicare.notification.notify({type:e.status,message:e.message})},error:function(e){raicare.core.log("ajax error occur on deleting role","error","Admin: roles",e),document.body.classList.remove("loading")}};raicare.ajax.send(n)};return e.openmodal=function(e){t=e.parentNode.parentNode,document.getElementById("currentRoleID").value=t.getElementsByTagName("td")[0].textContent,document.getElementById("updateRoleName").value=t.getElementsByTagName("td")[1].textContent,raicare.modal.show(a)},e.delete=function(e){s(e)},e.init=function(){a=document.getElementById("updateRoleModal"),a.addEventListener("submit",r),n=document.getElementById("newRoleModal"),n.addEventListener("submit",o)},e}({})},173:function(e,t){e.exports=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890",n=null,a=null,o=null,r=function(e){e.preventDefault();var t={url:"/admin/user/create",type:"POST",data:new FormData(n),beforeSend:function(){n.getElementsByClassName("modal__wrapper")[0].classList.add("loading")},success:function(e){e=JSON.parse(e),n.getElementsByClassName("modal__wrapper")[0].classList.remove("loading"),50===parseInt(e.code)&&window.location.reload(),raicare.notification.notify({type:e.status,message:e.message})},error:function(e){raicare.core.log("ajax error occur on creating new user","error","Admin: users",e),n.getElementsByClassName("modal__wrapper")[0].classList.remove("loading")}};raicare.ajax.send(t)},s=function(e){var t=e.closest(".js-field-name"),n=t.getElementsByClassName("form-group__control")[0],r=new FormData,s=[],l=[];if(r.append("csrf",document.getElementById("csrf").value),r.append("id",a.value),r.append("name",n.name),r.append("value",n.value),"pensions[]"===n.name){for(var i=n.getElementsByTagName("option"),c=0;c<i.length;c++)-1===s.indexOf(i[c].value)&&(s.push(i[c].value),l.push(i[c].textContent));r.append("value",JSON.stringify(s))}var u={url:"/admin/user/update",type:"POST",data:r,beforeSend:function(){o.classList.add("loading")},success:function(e){if(e=JSON.parse(e),o.classList.remove("loading"),53===parseInt(e.code))if(t.getElementsByClassName("form-group__control-static")[0].classList.toggle("hide"),t.getElementsByClassName("form-group__control-group")[0].classList.toggle("hide"),"role"===n.name)t.getElementsByClassName("js-user-info")[0].textContent=t.getElementsByClassName("form-group__control")[0].getElementsByTagName("option")[0].textContent;else if("organization"===n.name)t.getElementsByClassName("js-user-info")[0].textContent=t.getElementsByClassName("form-group__control")[0].getElementsByTagName("option")[0].textContent,t.getElementsByClassName("js-user-info")[0].href=window.location.origin+"/organization/"+n.value;else if("pensions[]"===n.name){var a=t.getElementsByClassName("form-group__control-static")[0];a.innerHTML="";for(var r=0;r<s.length;r++)a.innerHTML+='<a href="'+window.location.origin+"/pension/"+s[r]+'" class="js-user-info link m-r-10">'+l[r]+"</a>";a.innerHTML+='<a onclick="admin.users.edit(this)" role="button" class="m-l-5"><i class="fa fa-pencil" aria-hidden="true"></i></a>'}else t.getElementsByClassName("js-user-info")[0].textContent=n.value;raicare.notification.notify({type:e.status,message:e.message})},error:function(e){raicare.core.log("ajax error occur on updating user info","error","Admin: users",e),o.classList.remove("loading")}};raicare.ajax.send(u)};return e.update=function(e){s(e)},e.edit=function(e){var t=e.closest(".js-field-name");t.getElementsByClassName("form-group__control-static")[0].classList.toggle("hide"),t.getElementsByClassName("form-group__control-group")[0].classList.toggle("hide")},e.randompassword=function(e){for(var n,a="",o=0;o<10;o++)n=Math.floor(Math.random()*t.length),a+=t.substring(n,n+1);e.parentNode.getElementsByTagName("input")[0].value=a},e.init=function(e){if("all"===e)n=document.getElementById("newUserModal"),n.addEventListener("submit",r),new DataTable("#users",{perPage:20,perPageSelect:[20,40,60,80,100],searchable:!0,sortable:!0,labels:{placeholder:"Поиск...",perPage:"{select} пользователей на странице",noRows:"Пользователи не найдены",info:"Показано с {start} по {end} из {rows}"},nextPrev:!1,footer:!0});else{a=document.getElementById("userID"),o=document.getElementById("userInfo");var t=new raicare.choices("#userOrganization",{placeholderValue:"Введите название организации",loadingText:"Загрузка...",noResultsText:"Ничего не найдено",noChoicesText:"Нет элементов для выбора",itemSelectText:"выбрать",searchEnabled:!0,searchChoices:!1,searchFloor:2,searchResultLimit:30,resetScrollPosition:!1});t.passedElement.addEventListener("search",function(e){t.ajax(function(n){fetch("/admin/organization/get?name="+e.detail.value).then(function(e){return e.json()}).then(function(e){t.setChoices(e,"id","name",!0)}).catch(function(e){console.log(e)})})});var s=new raicare.choices("#userPensions",{removeItemButton:!0,placeholderValue:"Введите название пансионата",loadingText:"Загрузка...",noResultsText:"Ничего не найдено",noChoicesText:"Нет элементов для выбора",itemSelectText:"выбрать",searchEnabled:!0,searchChoices:!1,searchFloor:2,searchResultLimit:30,resetScrollPosition:!1});s.passedElement.addEventListener("search",function(e){s.ajax(function(t){fetch("/admin/pension/get?name="+e.detail.value).then(function(e){return e.json()}).then(function(e){s.setChoices(e,"id","name",!0)}).catch(function(e){console.log(e)})})})}},e}({})},210:function(e,t,n){e.exports=function(e){return e.roles=n(172),e.users=n(173),e}({})}});