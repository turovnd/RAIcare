var clients=function(e){function t(o){if(n[o])return n[o].exports;var s=n[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=21)}({21:function(e,t,n){e.exports=function(e){return e.add=n(7),e.request=n(9),e.edit=n(8),e.create=n(27),e}({})},27:function(e,t){e.exports=function(e){var t="Clients: creating";return e.user=function(){var e=new FormData;e.append("csrf",document.getElementById("csrf").value),e.append("client_id",document.getElementById("clientId").value);var n={url:"/client/adduser",type:"POST",data:e,success:function(e){e=JSON.parse(e),raisoft.core.log(e.message,e.status,t),raisoft.notification.notify({type:e.status,message:e.message}),29===parseInt(e.code)&&window.setTimeout(function(){window.location.reload()},100)},error:function(e){raisoft.core.log("ajax error occur on submitting creating new user form","error",t,e)}};raisoft.ajax.send(n)},e.organization=function(e){var n=document.getElementById(e);if(!n)return void raisoft.core.log("Не удается найти форму создания организайии. Перезагрузте страницу","error",t);var o=new FormData(n);o.append("csrf",document.getElementById("csrf").value),o.append("userId",document.getElementById("userId").value);var s={url:"/client/addorganization",type:"POST",data:o,beforeSend:function(){n.getElementsByClassName("modal__content")[0].classList.add("loading")},success:function(e){if(e=JSON.parse(e),raisoft.core.log(e.message,e.status,t),n.getElementsByClassName("modal__content")[0].classList.remove("loading"),raisoft.notification.notify({type:e.status,message:e.message}),133===parseInt(e.code)){raisoft.draw.node("DIV","item clear-fix",{id:"organization_"+e.id});n.reset(),raisoft.modal.hide(n)}},error:function(e){raisoft.core.log("ajax error occur on submitting new client form","error",t,e),n.getElementsByClassName("modal__content")[0].classList.remove("loading")}};raisoft.ajax.send(s)},e.pension=function(e){},e}({})},7:function(e,t){e.exports=function(e){function t(){var e=document.getElementById("addClientModal");e&&e.addEventListener("submit",o)}function n(){for(var e=document.getElementsByClassName("tabs__btn"),t=raisoft.cookies.get("clients"),n=0;n<e.length;n++)e[n].addEventListener("click",s);void 0!==t&&document.querySelector('[data-block="'+t+'"]')&&document.querySelector('[data-block="'+t+'"]').click()}function o(e){e.preventDefault();var t=this,n=new FormData(t);n.append("csrf",document.getElementById("csrf").value);var o={url:"/client/add",type:"POST",data:n,beforeSend:function(){t.getElementsByClassName("modal__content")[0].classList.add("loading")},success:function(e){if(e=JSON.parse(e),raisoft.core.log(e.message,e.status,a),t.getElementsByClassName("modal__content")[0].classList.remove("loading"),raisoft.notification.notify({type:e.status,message:e.message}),22===parseInt(e.code)){var n=raisoft.draw.node("DIV","item clear-fix",{id:"client_"+e.id});n.innerHTML='<a href="/client/'+e.id+'" class="col-xs-3 col-sm-2 col-lg-1 text-center"><i class="fa fa-id-card-o fa-4x" aria-hidden="true"></i></a><ul class="col-xs-9 col-sm-10 col-lg-11 list-style--none"><li class="item__text col-xs-12"><div class="col-xs-12 col-sm-3 col-md-2 text-bold">Имя</div><div class="col-xs-12 col-sm-9 col-md-10 item__search-text">'+document.getElementById("addClientName").value+'</div></li><li class="item__text col-xs-12"><div class="col-xs-12 col-sm-3 col-md-2 text-bold">Эл. почта</div><div class="col-xs-12 col-sm-9 col-md-10">'+document.getElementById("addClientEmail").value+'</div></li><li class="item__text col-xs-12"><div class="col-xs-12 col-sm-3 col-md-2 text-bold">Телефон</div><div class="col-xs-12 col-sm-9 col-md-10">'+document.getElementById("addClientPhone").value+"</div></li></ul>",document.getElementById("withoutAccessClients").insertBefore(n,document.getElementById("withoutAccessClients").childNodes[0]),document.getElementById("withoutAccessClientsCounter").textContent=parseInt(document.getElementById("withoutAccessClientsCounter").textContent)+1,t.reset(),raisoft.modal.hide(t)}},error:function(e){raisoft.core.log("ajax error occur on submitting new client form","error",a,e),t.getElementsByClassName("modal__content")[0].classList.remove("loading")}};raisoft.ajax.send(o)}function s(){raisoft.cookies.set({name:"clients",value:this.dataset.block,expires:3600,path:"/"})}var a="Clients: add new";return e.init=function(){t(),n()},e}({})},8:function(e,t){e.exports=function(e){function t(){var e=document.getElementsByClassName("js-edit-info"),t=document.getElementsByClassName("js-save-info");for(s=0;s<e.length;s++)e[s].addEventListener("click",n);for(s=0;s<t.length;s++)t[s].addEventListener("click",o);r=document.getElementById("clientId").value,c=document.getElementById("csrf").value,i=document.getElementById("application")}function n(){var e=this.closest(".js-field-name");e.getElementsByClassName("form-group__control-static")[0].classList.toggle("hide"),e.getElementsByClassName("form-group__control-group")[0].classList.toggle("hide")}function o(){var e=this.closest(".js-field-name"),t=e.getElementsByClassName("form-group__control")[0].value,n=e.getElementsByClassName("form-group__control")[0].name,o=new FormData;o.append("id",r),o.append("csrf",c),o.append("name",n),o.append("value",t);var s={url:"/client/update",type:"POST",data:o,beforeSend:function(){i.classList.add("loading")},success:function(n){n=JSON.parse(n),raisoft.core.log(n.message,n.status,a),i.classList.remove("loading"),raisoft.notification.notify({type:n.status,message:n.message}),27===parseInt(n.code)&&(e.getElementsByClassName("js-client-info")[0].textContent=t,e.getElementsByClassName("form-group__control-static")[0].classList.toggle("hide"),e.getElementsByClassName("form-group__control-group")[0].classList.toggle("hide"))},error:function(e){raisoft.core.log("ajax error occur on updating client info","error",a,e),i.classList.remove("loading")}};raisoft.ajax.send(s)}var s,a="Clients: edit info",i=null,r=null,c=null;return e.init=function(){t()},e}({})},9:function(e,t){e.exports=function(e){function t(){var e=document.getElementsByClassName("js-request-accept")[0],t=document.getElementsByClassName("js-request-reject")[0];e&&e.addEventListener("click",n),t&&t.addEventListener("click",o),i=new FormData,i.append("id",document.getElementById("clientId").value),i.append("csrf",document.getElementById("csrf").value)}function n(){i.append("status","accept"),s()}function o(){i.append("status","reject"),s()}function s(){var e=document.getElementById("application"),t={url:"/client/changestatus",type:"POST",data:i,beforeSend:function(){e.classList.add("loading")},success:function(t){t=JSON.parse(t),raisoft.core.log(t.message,t.status,a),e.classList.remove("loading"),raisoft.notification.notify({type:t.status,message:t.message}),window.setTimeout(function(){24===parseInt(t.code)&&window.location.reload(),25===parseInt(t.code)&&window.history.back()},1e3)},error:function(t){raisoft.core.log("ajax error occur on submitting application form","error",a,t),e.classList.remove("loading")}};raisoft.ajax.send(t)}var a="Clients: requests",i=null;return e.init=function(){t()},e}({})}});